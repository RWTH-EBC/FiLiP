

<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>filip.models.ngsi_ld.context &mdash; FiLiP 0.7.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/autodoc_pydantic.css" />

  
      <script src="../../../../_static/jquery.js"></script>
      <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
      <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
      <script src="../../../../_static/doctools.js"></script>
      <script src="../../../../_static/sphinx_highlight.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../contents.html" class="icon icon-home">
            FiLiP
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../index.html">FiLiP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../api/index.html">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../contributing.html">Contribute as a user</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../contributing.html#contribute-as-a-developer">Contribute as a developer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../about/index.html">About FiLiP</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../contents.html">FiLiP</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../contents.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">filip.models.ngsi_ld.context</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for filip.models.ngsi_ld.context</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">NGSI LD models for context broker interaction</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Optional</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">geojson_pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">Point</span><span class="p">,</span>
    <span class="n">MultiPoint</span><span class="p">,</span>
    <span class="n">LineString</span><span class="p">,</span>
    <span class="n">MultiLineString</span><span class="p">,</span>
    <span class="n">Polygon</span><span class="p">,</span>
    <span class="n">MultiPolygon</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing_extensions</span><span class="w"> </span><span class="kn">import</span> <span class="n">Self</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">aenum</span><span class="w"> </span><span class="kn">import</span> <span class="n">Enum</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">field_validator</span><span class="p">,</span> <span class="n">ConfigDict</span><span class="p">,</span> <span class="n">BaseModel</span><span class="p">,</span> <span class="n">Field</span><span class="p">,</span> <span class="n">model_validator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">filip.models.ngsi_v2</span><span class="w"> </span><span class="kn">import</span> <span class="n">ContextEntity</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">filip.utils.validators</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">FiwareRegex</span><span class="p">,</span>
    <span class="n">validate_fiware_datatype_string_protect</span><span class="p">,</span>
    <span class="n">validate_fiware_standard_regex</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pydantic_core</span><span class="w"> </span><span class="kn">import</span> <span class="n">ValidationError</span>


<div class="viewcode-block" id="DataTypeLD"><a class="viewcode-back" href="../../../../code/filip.models.ngsi_ld.html#filip.models.ngsi_ld.context.DataTypeLD">[docs]</a><span class="k">class</span><span class="w"> </span><span class="nc">DataTypeLD</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    In NGSI-LD the data types on context entities are only divided into properties and relationships.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_init_</span> <span class="o">=</span> <span class="s2">&quot;value __doc__&quot;</span>
    <span class="n">GEOPROPERTY</span> <span class="o">=</span> <span class="s2">&quot;GeoProperty&quot;</span><span class="p">,</span> <span class="s2">&quot;A property that represents a geometry value&quot;</span>
    <span class="n">PROPERTY</span> <span class="o">=</span> <span class="s2">&quot;Property&quot;</span><span class="p">,</span> <span class="s2">&quot;All attributes that do not represent a relationship&quot;</span>
    <span class="n">RELATIONSHIP</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;Relationship&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Reference to another context entity, which can be identified with a URN.&quot;</span><span class="p">,</span>
    <span class="p">)</span></div>


<span class="c1"># NGSI-LD entity models</span>
<div class="viewcode-block" id="ContextProperty"><a class="viewcode-back" href="../../../../code/filip.models.ngsi_ld.html#filip.models.ngsi_ld.context.ContextProperty">[docs]</a><span class="k">class</span><span class="w"> </span><span class="nc">ContextProperty</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The model for a property is represented by a JSON object with the following syntax:</span>

<span class="sd">    The attribute value is specified by the value, whose value can be any data type. This does not need to be</span>
<span class="sd">    specified further.</span>

<span class="sd">    The NGSI type of the attribute is fixed and does not need to be specified.</span>
<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; data = {&quot;value&quot;: &lt;...&gt;}</span>

<span class="sd">        &gt;&gt;&gt; attr = ContextProperty(**data)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">model_config</span> <span class="o">=</span> <span class="n">ConfigDict</span><span class="p">(</span><span class="n">extra</span><span class="o">=</span><span class="s2">&quot;allow&quot;</span><span class="p">)</span>  <span class="c1"># In order to allow nested properties</span>
    <span class="nb">type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;Property&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
        <span class="n">Union</span><span class="p">[</span>
            <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span>
            <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]],</span>
        <span class="p">]</span>
    <span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Property value&quot;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;the actual data&quot;</span><span class="p">)</span>
    <span class="n">observedAt</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Timestamp&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Representing a timestamp for the &quot;</span>
        <span class="s2">&quot;incoming value of the property.&quot;</span><span class="p">,</span>
        <span class="n">max_length</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
        <span class="n">min_length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">field_validator</span><span class="p">(</span><span class="s2">&quot;observedAt&quot;</span><span class="p">)(</span><span class="n">validate_fiware_datatype_string_protect</span><span class="p">)</span>

    <span class="n">createdAt</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Timestamp&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Representing a timestamp for the &quot;</span>
        <span class="s2">&quot;creation time of the property.&quot;</span><span class="p">,</span>
        <span class="n">max_length</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
        <span class="n">min_length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">field_validator</span><span class="p">(</span><span class="s2">&quot;createdAt&quot;</span><span class="p">)(</span><span class="n">validate_fiware_datatype_string_protect</span><span class="p">)</span>

    <span class="n">modifiedAt</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Timestamp&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Representing a timestamp for the &quot;</span>
        <span class="s2">&quot;last modification of the property.&quot;</span><span class="p">,</span>
        <span class="n">max_length</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
        <span class="n">min_length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">field_validator</span><span class="p">(</span><span class="s2">&quot;modifiedAt&quot;</span><span class="p">)(</span><span class="n">validate_fiware_datatype_string_protect</span><span class="p">)</span>

    <span class="n">unitCode</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Unit Code&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Representing the unit of the value. &quot;</span>
        <span class="s2">&quot;Should be part of the defined units &quot;</span>
        <span class="s2">&quot;by the UN/ECE Recommendation No. 21&quot;</span>
        <span class="s2">&quot;https://unece.org/fileadmin/DAM/cefact/recommendations/rec20/rec20_rev3_Annex2e.pdf &quot;</span><span class="p">,</span>
        <span class="n">max_length</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
        <span class="n">min_length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">field_validator</span><span class="p">(</span><span class="s2">&quot;unitCode&quot;</span><span class="p">)(</span><span class="n">validate_fiware_datatype_string_protect</span><span class="p">)</span>

    <span class="n">datasetId</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;dataset Id&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;It allows identifying a set or group of property values&quot;</span><span class="p">,</span>
        <span class="n">max_length</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
        <span class="n">min_length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">field_validator</span><span class="p">(</span><span class="s2">&quot;datasetId&quot;</span><span class="p">)(</span><span class="n">validate_fiware_datatype_string_protect</span><span class="p">)</span>

<div class="viewcode-block" id="ContextProperty.get_model_fields_set"><a class="viewcode-back" href="../../../../code/filip.models.ngsi_ld.html#filip.models.ngsi_ld.context.ContextProperty.get_model_fields_set">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_model_fields_set</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get all names and aliases of the model fields.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">set</span><span class="p">(</span>
            <span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">validation_alias</span> <span class="k">for</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">model_fields</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
            <span class="o">+</span> <span class="p">[</span><span class="n">field_name</span> <span class="k">for</span> <span class="n">field_name</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">model_fields</span><span class="p">]</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="ContextProperty.check_property_type"><a class="viewcode-back" href="../../../../code/filip.models.ngsi_ld.html#filip.models.ngsi_ld.context.ContextProperty.check_property_type">[docs]</a>    <span class="nd">@field_validator</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">check_property_type</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Force property type to be &quot;Property&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            value: value field</span>
<span class="sd">        Returns:</span>
<span class="sd">            value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">valid_property_types</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Property&quot;</span><span class="p">,</span> <span class="s2">&quot;Relationship&quot;</span><span class="p">,</span> <span class="s2">&quot;TemporalProperty&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid_property_types</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;NGSI_LD Properties must have type </span><span class="si">{</span><span class="n">valid_property_types</span><span class="si">}</span><span class="s2">, &quot;</span>
                <span class="sa">f</span><span class="s1">&#39;not &quot;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s1">&quot;&#39;</span>
            <span class="p">)</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">value</span></div></div>


<div class="viewcode-block" id="NamedContextProperty"><a class="viewcode-back" href="../../../../code/filip.models.ngsi_ld.html#filip.models.ngsi_ld.context.NamedContextProperty">[docs]</a><span class="k">class</span><span class="w"> </span><span class="nc">NamedContextProperty</span><span class="p">(</span><span class="n">ContextProperty</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Context properties are properties of context entities. For example, the current speed of a car could be modeled</span>
<span class="sd">    as the current_speed property of the car-104 entity.</span>

<span class="sd">    In the NGSI-LD data model, properties have a name, the type &quot;property&quot; and a value.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Property name&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The property name describes what kind of property the &quot;</span>
        <span class="s2">&quot;attribute value represents of the entity, for example &quot;</span>
        <span class="s2">&quot;current_speed. Allowed characters &quot;</span>
        <span class="s2">&quot;are the ones in the plain ASCII set, except the following &quot;</span>
        <span class="s2">&quot;ones: control characters, whitespace, &amp;, ?, / and #.&quot;</span><span class="p">,</span>
        <span class="n">max_length</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
        <span class="n">min_length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">field_validator</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">)(</span><span class="n">validate_fiware_datatype_string_protect</span><span class="p">)</span></div>


<div class="viewcode-block" id="ContextGeoPropertyValue"><a class="viewcode-back" href="../../../../code/filip.models.ngsi_ld.html#filip.models.ngsi_ld.context.ContextGeoPropertyValue">[docs]</a><span class="k">class</span><span class="w"> </span><span class="nc">ContextGeoPropertyValue</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The value for a Geo property is represented by a JSON object with the following syntax:</span>

<span class="sd">    A type with value &quot;Point&quot; and the</span>
<span class="sd">    coordinates with a list containing the coordinates as value</span>

<span class="sd">    Example:</span>
<span class="sd">        &quot;value&quot;: {</span>
<span class="sd">            &quot;type&quot;: &quot;Point&quot;,</span>
<span class="sd">            &quot;coordinates&quot;: [</span>
<span class="sd">                -3.80356167695194,</span>
<span class="sd">                43.46296641666926</span>
<span class="sd">            ]</span>
<span class="sd">        }</span>
<span class="sd">    }</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">model_config</span> <span class="o">=</span> <span class="n">ConfigDict</span><span class="p">(</span><span class="n">extra</span><span class="o">=</span><span class="s2">&quot;allow&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="ContextGeoPropertyValue.check_geoproperty_value"><a class="viewcode-back" href="../../../../code/filip.models.ngsi_ld.html#filip.models.ngsi_ld.context.ContextGeoPropertyValue.check_geoproperty_value">[docs]</a>    <span class="nd">@model_validator</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;after&quot;</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">check_geoproperty_value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check if the value is a valid GeoProperty</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dump</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;Point&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">model_dump</span><span class="p">())</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dump</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;LineString&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">LineString</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">model_dump</span><span class="p">())</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dump</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;Polygon&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Polygon</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">model_dump</span><span class="p">())</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dump</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;MultiPoint&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">MultiPoint</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">model_dump</span><span class="p">())</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dump</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;MultiLineString&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">MultiLineString</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">model_dump</span><span class="p">())</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dump</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;MultiPolygon&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">MultiPolygon</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">model_dump</span><span class="p">())</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dump</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;GeometryCollection&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;GeometryCollection is not supported&quot;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="ContextGeoProperty"><a class="viewcode-back" href="../../../../code/filip.models.ngsi_ld.html#filip.models.ngsi_ld.context.ContextGeoProperty">[docs]</a><span class="k">class</span><span class="w"> </span><span class="nc">ContextGeoProperty</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The model for a Geo property is represented by a JSON object with the following syntax:</span>

<span class="sd">    The attribute value is a JSON object with two contents.</span>

<span class="sd">    Example:</span>

<span class="sd">        {</span>
<span class="sd">        &quot;type&quot;: &quot;GeoProperty&quot;,</span>
<span class="sd">        &quot;value&quot;: {</span>
<span class="sd">            &quot;type&quot;: &quot;Point&quot;,</span>
<span class="sd">            &quot;coordinates&quot;: [</span>
<span class="sd">                -3.80356167695194,</span>
<span class="sd">                43.46296641666926</span>
<span class="sd">            ]</span>
<span class="sd">        }</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">model_config</span> <span class="o">=</span> <span class="n">ConfigDict</span><span class="p">(</span><span class="n">extra</span><span class="o">=</span><span class="s2">&quot;allow&quot;</span><span class="p">)</span>
    <span class="nb">type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;GeoProperty&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
        <span class="n">Union</span><span class="p">[</span>
            <span class="n">ContextGeoPropertyValue</span><span class="p">,</span>
            <span class="n">Point</span><span class="p">,</span>
            <span class="n">LineString</span><span class="p">,</span>
            <span class="n">Polygon</span><span class="p">,</span>
            <span class="n">MultiPoint</span><span class="p">,</span>
            <span class="n">MultiPolygon</span><span class="p">,</span>
            <span class="n">MultiLineString</span><span class="p">,</span>
        <span class="p">]</span>
    <span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;GeoProperty value&quot;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;the actual data&quot;</span><span class="p">)</span>
    <span class="n">observedAt</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Timestamp&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Representing a timestamp for the &quot;</span>
        <span class="s2">&quot;incoming value of the property.&quot;</span><span class="p">,</span>
        <span class="n">max_length</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
        <span class="n">min_length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">field_validator</span><span class="p">(</span><span class="s2">&quot;observedAt&quot;</span><span class="p">)(</span><span class="n">validate_fiware_datatype_string_protect</span><span class="p">)</span>

    <span class="n">datasetId</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;dataset Id&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;It allows identifying a set or group of property values&quot;</span><span class="p">,</span>
        <span class="n">max_length</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
        <span class="n">min_length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">field_validator</span><span class="p">(</span><span class="s2">&quot;datasetId&quot;</span><span class="p">)(</span><span class="n">validate_fiware_datatype_string_protect</span><span class="p">)</span></div>


<div class="viewcode-block" id="NamedContextGeoProperty"><a class="viewcode-back" href="../../../../code/filip.models.ngsi_ld.html#filip.models.ngsi_ld.context.NamedContextGeoProperty">[docs]</a><span class="k">class</span><span class="w"> </span><span class="nc">NamedContextGeoProperty</span><span class="p">(</span><span class="n">ContextGeoProperty</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Context GeoProperties are geo properties of context entities. For example, the coordinates of a building .</span>

<span class="sd">    In the NGSI-LD data model, properties have a name, the type &quot;Geoproperty&quot; and a value.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Property name&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The property name describes what kind of property the &quot;</span>
        <span class="s2">&quot;attribute value represents of the entity, for example &quot;</span>
        <span class="s2">&quot;current_speed. Allowed characters &quot;</span>
        <span class="s2">&quot;are the ones in the plain ASCII set, except the following &quot;</span>
        <span class="s2">&quot;ones: control characters, whitespace, &amp;, ?, / and #.&quot;</span><span class="p">,</span>
        <span class="n">max_length</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
        <span class="n">min_length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">field_validator</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">)(</span><span class="n">validate_fiware_datatype_string_protect</span><span class="p">)</span></div>


<div class="viewcode-block" id="ContextRelationship"><a class="viewcode-back" href="../../../../code/filip.models.ngsi_ld.html#filip.models.ngsi_ld.context.ContextRelationship">[docs]</a><span class="k">class</span><span class="w"> </span><span class="nc">ContextRelationship</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The model for a relationship is represented by a JSON object with the following syntax:</span>

<span class="sd">    The attribute value is specified by the object, whose value can be a reference to another context entity. This</span>
<span class="sd">    should be specified as the URN. The existence of this entity is not assumed.</span>

<span class="sd">    The NGSI type of the attribute is fixed and does not need to be specified.</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; data = {&quot;object&quot;: &lt;...&gt;}</span>

<span class="sd">        &gt;&gt;&gt; attr = ContextRelationship(**data)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">model_config</span> <span class="o">=</span> <span class="n">ConfigDict</span><span class="p">(</span><span class="n">extra</span><span class="o">=</span><span class="s2">&quot;allow&quot;</span><span class="p">)</span>  <span class="c1"># In order to allow nested relationships</span>
    <span class="nb">type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;Relationship&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="nb">object</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
        <span class="n">Union</span><span class="p">[</span>
            <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span>
            <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]],</span>
        <span class="p">]</span>
    <span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Realtionship object&quot;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;the actual object id&quot;</span>
    <span class="p">)</span>

    <span class="n">datasetId</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;dataset Id&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;It allows identifying a set or group of property values&quot;</span><span class="p">,</span>
        <span class="n">max_length</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
        <span class="n">min_length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">field_validator</span><span class="p">(</span><span class="s2">&quot;datasetId&quot;</span><span class="p">)(</span><span class="n">validate_fiware_datatype_string_protect</span><span class="p">)</span>

    <span class="n">observedAt</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span>
        <span class="n">titel</span><span class="o">=</span><span class="s2">&quot;Timestamp&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Representing a timestamp for the &quot;</span>
        <span class="s2">&quot;incoming value of the property.&quot;</span><span class="p">,</span>
        <span class="n">max_length</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
        <span class="n">min_length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">field_validator</span><span class="p">(</span><span class="s2">&quot;observedAt&quot;</span><span class="p">)(</span><span class="n">validate_fiware_datatype_string_protect</span><span class="p">)</span>

<div class="viewcode-block" id="ContextRelationship.check_relationship_type"><a class="viewcode-back" href="../../../../code/filip.models.ngsi_ld.html#filip.models.ngsi_ld.context.ContextRelationship.check_relationship_type">[docs]</a>    <span class="nd">@field_validator</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">check_relationship_type</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Force property type to be &quot;Relationship&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            value: value field</span>
<span class="sd">        Returns:</span>
<span class="sd">            value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;Relationship&quot;</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;NGSI_LD relationships must have type &quot;Relationship&quot;&#39;</span><span class="p">)</span>
        <span class="n">value</span> <span class="o">=</span> <span class="s2">&quot;Relationship&quot;</span>
        <span class="k">return</span> <span class="n">value</span></div></div>


<div class="viewcode-block" id="NamedContextRelationship"><a class="viewcode-back" href="../../../../code/filip.models.ngsi_ld.html#filip.models.ngsi_ld.context.NamedContextRelationship">[docs]</a><span class="k">class</span><span class="w"> </span><span class="nc">NamedContextRelationship</span><span class="p">(</span><span class="n">ContextRelationship</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Context Relationship are relations of context entities to each other.</span>
<span class="sd">    For example, the current_speed of the entity car-104 could be modeled.</span>
<span class="sd">    The location could be modeled as located_in the entity Room-001.</span>

<span class="sd">    In the NGSI-LD data model, relationships have a name, the type &quot;relationship&quot; and an object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Attribute name&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The attribute name describes what kind of property the &quot;</span>
        <span class="s2">&quot;attribute value represents of the entity, for example &quot;</span>
        <span class="s2">&quot;current_speed. Allowed characters &quot;</span>
        <span class="s2">&quot;are the ones in the plain ASCII set, except the following &quot;</span>
        <span class="s2">&quot;ones: control characters, whitespace, &amp;, ?, / and #.&quot;</span><span class="p">,</span>
        <span class="n">max_length</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
        <span class="n">min_length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="c1"># pattern=FiwareRegex.string_protect.value,</span>
        <span class="c1"># Make it FIWARE-Safe</span>
    <span class="p">)</span>
    <span class="n">field_validator</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">)(</span><span class="n">validate_fiware_datatype_string_protect</span><span class="p">)</span></div>


<div class="viewcode-block" id="ContextLDEntityBase"><a class="viewcode-back" href="../../../../code/filip.models.ngsi_ld.html#filip.models.ngsi_ld.context.ContextLDEntityBase">[docs]</a><span class="k">class</span><span class="w"> </span><span class="nc">ContextLDEntityBase</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base Model for an entity is represented by a JSON object with the following</span>
<span class="sd">    syntax.</span>

<span class="sd">    The entity id is specified by the object&#39;s id property, whose value</span>
<span class="sd">    is a string containing the entity id.</span>

<span class="sd">    The entity type is specified by the object&#39;s type property, whose value</span>
<span class="sd">    is a string containing the entity&#39;s type name.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">model_config</span> <span class="o">=</span> <span class="n">ConfigDict</span><span class="p">(</span>
        <span class="n">extra</span><span class="o">=</span><span class="s2">&quot;allow&quot;</span><span class="p">,</span> <span class="n">validate_default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">validate_assignment</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="o">...</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Entity Id&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Id of an entity in an NGSI context broker. Allowed &quot;</span>
        <span class="s2">&quot;characters are the ones in the plain ASCII set, except &quot;</span>
        <span class="s2">&quot;the following ones: control characters, &quot;</span>
        <span class="s2">&quot;whitespace, &amp;, ?, / and #.&quot;</span>
        <span class="s2">&quot;the id should be structured according to the urn naming scheme.&quot;</span><span class="p">,</span>
        <span class="n">json_schema_extra</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;example&quot;</span><span class="p">:</span> <span class="s2">&quot;urn:ngsi-ld:Room:001&quot;</span><span class="p">},</span>
        <span class="n">max_length</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
        <span class="n">min_length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="c1"># pattern=FiwareRegex.standard.value,  # Make it FIWARE-Safe</span>
        <span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">field_validator</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)(</span><span class="n">validate_fiware_standard_regex</span><span class="p">)</span>
    <span class="nb">type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="o">...</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Entity Type&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Id of an entity in an NGSI context broker. &quot;</span>
        <span class="s2">&quot;Allowed characters are the ones in the plain ASCII set, &quot;</span>
        <span class="s2">&quot;except the following ones: control characters, &quot;</span>
        <span class="s2">&quot;whitespace, &amp;, ?, / and #.&quot;</span><span class="p">,</span>
        <span class="n">json_schema_extra</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;example&quot;</span><span class="p">:</span> <span class="s2">&quot;Room&quot;</span><span class="p">},</span>
        <span class="n">max_length</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
        <span class="n">min_length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="c1"># pattern=FiwareRegex.standard.value,  # Make it FIWARE-Safe</span>
        <span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">field_validator</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)(</span><span class="n">validate_fiware_standard_regex</span><span class="p">)</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Dict</span><span class="p">]]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;@context&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The @context in JSON-LD is used to expand terms, provided as short &quot;</span>
        <span class="s2">&quot;hand strings, to concepts, specified as URIs, and vice versa, &quot;</span>
        <span class="s2">&quot;to compact URIs into terms &quot;</span>
        <span class="s2">&quot;The main implication of NGSI-LD API is that if the @context is &quot;</span>
        <span class="s2">&quot;a compound one, i.e. an @context which references multiple &quot;</span>
        <span class="s2">&quot;individual @context, served by resources behind different URIs, &quot;</span>
        <span class="s2">&quot;then a wrapper @context has to be created and hosted.&quot;</span><span class="p">,</span>
        <span class="n">examples</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;https://n5geh.github.io/n5geh.test-context.io/context_saref.jsonld&quot;</span><span class="p">],</span>
        <span class="n">alias</span><span class="o">=</span><span class="s2">&quot;@context&quot;</span><span class="p">,</span>
        <span class="n">validation_alias</span><span class="o">=</span><span class="s2">&quot;@context&quot;</span><span class="p">,</span>
        <span class="n">frozen</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span></div>


<div class="viewcode-block" id="ContextLDEntityKeyValues"><a class="viewcode-back" href="../../../../code/filip.models.ngsi_ld.html#filip.models.ngsi_ld.context.ContextLDEntityKeyValues">[docs]</a><span class="k">class</span><span class="w"> </span><span class="nc">ContextLDEntityKeyValues</span><span class="p">(</span><span class="n">ContextLDEntityBase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base Model for an entity is represented by a JSON object with the following</span>
<span class="sd">    syntax.</span>

<span class="sd">    The entity id is specified by the object&#39;s id property, whose value</span>
<span class="sd">    is a string containing the entity id.</span>

<span class="sd">    The entity type is specified by the object&#39;s type property, whose value</span>
<span class="sd">    is a string containing the entity&#39;s type name.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">model_config</span> <span class="o">=</span> <span class="n">ConfigDict</span><span class="p">(</span>
        <span class="n">extra</span><span class="o">=</span><span class="s2">&quot;allow&quot;</span><span class="p">,</span> <span class="n">validate_default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">validate_assignment</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>

<div class="viewcode-block" id="ContextLDEntityKeyValues.to_entity"><a class="viewcode-back" href="../../../../code/filip.models.ngsi_ld.html#filip.models.ngsi_ld.context.ContextLDEntityKeyValues.to_entity">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_entity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert the entity to a normalized representation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ContextLDEntity</span><span class="p">(</span>
            <span class="o">**</span><span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">,</span>
                <span class="s2">&quot;context&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="o">**</span><span class="p">{</span>
                    <span class="n">key</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Property&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">value</span><span class="p">,</span>
                    <span class="p">}</span>
                    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dump</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;context&quot;</span><span class="p">]</span>
                <span class="p">},</span>
            <span class="p">}</span>
        <span class="p">)</span></div></div>


<div class="viewcode-block" id="PropertyFormat"><a class="viewcode-back" href="../../../../code/filip.models.ngsi_ld.html#filip.models.ngsi_ld.context.PropertyFormat">[docs]</a><span class="k">class</span><span class="w"> </span><span class="nc">PropertyFormat</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Format to decide if properties of ContextEntity class are returned as</span>
<span class="sd">    List of NamedContextAttributes or as Dict of ContextAttributes.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">LIST</span> <span class="o">=</span> <span class="s2">&quot;list&quot;</span>
    <span class="n">DICT</span> <span class="o">=</span> <span class="s2">&quot;dict&quot;</span></div>


<div class="viewcode-block" id="ContextLDEntity"><a class="viewcode-back" href="../../../../code/filip.models.ngsi_ld.html#filip.models.ngsi_ld.context.ContextLDEntity">[docs]</a><span class="k">class</span><span class="w"> </span><span class="nc">ContextLDEntity</span><span class="p">(</span><span class="n">ContextLDEntityBase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Context LD entities, or simply entities, are the center of gravity in the</span>
<span class="sd">    FIWARE NGSI-LD information model. An entity represents a thing, i.e., any</span>
<span class="sd">    physical or logical object (e.g., a sensor, a person, a room, an issue in</span>
<span class="sd">    a ticketing system, etc.). Each entity has an entity id.</span>
<span class="sd">    Furthermore, the type system of FIWARE NGSI enables entities to have an</span>
<span class="sd">    entity type. Entity types are semantic types; they are intended to describe</span>
<span class="sd">    the type of thing represented by the entity. For example, a context</span>
<span class="sd">    entity #with id sensor-365 could have the type temperatureSensor.</span>

<span class="sd">    Each entity is uniquely identified by its id.</span>

<span class="sd">    The entity id is specified by the object&#39;s id property, whose value</span>
<span class="sd">    is a string containing the entity id.</span>

<span class="sd">    The entity type is specified by the object&#39;s type property, whose value</span>
<span class="sd">    is a string containing the entity&#39;s type name.</span>

<span class="sd">    Entity attributes are specified by additional properties and relationships, whose names are</span>
<span class="sd">    the name of the attribute and whose representation is described in the</span>
<span class="sd">    &quot;ContextProperty&quot;/&quot;ContextRelationship&quot;-model. Obviously, id and type are</span>
<span class="sd">    not allowed to be used as attribute names.</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; data = {&#39;id&#39;: &#39;MyId&#39;,</span>
<span class="sd">                    &#39;type&#39;: &#39;MyType&#39;,</span>
<span class="sd">                    &#39;my_attr&#39;: {&#39;value&#39;: 20}}</span>

<span class="sd">        &gt;&gt;&gt; entity = ContextLDEntity(**data)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">model_config</span> <span class="o">=</span> <span class="n">ConfigDict</span><span class="p">(</span>
        <span class="n">extra</span><span class="o">=</span><span class="s2">&quot;allow&quot;</span><span class="p">,</span>
        <span class="n">validate_default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">validate_assignment</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">populate_by_name</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">observationSpace</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ContextGeoProperty</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Observation Space&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The geospatial Property representing &quot;</span>
        <span class="s2">&quot;the geographic location that is being &quot;</span>
        <span class="s2">&quot;observed, e.g. by a sensor. &quot;</span>
        <span class="s2">&quot;For example, in the case of a camera, &quot;</span>
        <span class="s2">&quot;the location of the camera and the &quot;</span>
        <span class="s2">&quot;observationspace are different and &quot;</span>
        <span class="s2">&quot;can be disjoint. &quot;</span><span class="p">,</span>
    <span class="p">)</span>

<div class="viewcode-block" id="ContextLDEntity.return_context"><a class="viewcode-back" href="../../../../code/filip.models.ngsi_ld.html#filip.models.ngsi_ld.context.ContextLDEntity.return_context">[docs]</a>    <span class="nd">@field_validator</span><span class="p">(</span><span class="s2">&quot;context&quot;</span><span class="p">)</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">return_context</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">context</span></div>

    <span class="n">operationSpace</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ContextGeoProperty</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Operation Space&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The geospatial Property representing &quot;</span>
        <span class="s2">&quot;the geographic location in which an &quot;</span>
        <span class="s2">&quot;Entity,e.g. an actuator is active. &quot;</span>
        <span class="s2">&quot;For example, a crane can have a &quot;</span>
        <span class="s2">&quot;certain operation space.&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">createdAt</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Timestamp&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Representing a timestamp for the &quot;</span>
        <span class="s2">&quot;creation time of the property.&quot;</span><span class="p">,</span>
        <span class="n">max_length</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
        <span class="n">min_length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">field_validator</span><span class="p">(</span><span class="s2">&quot;createdAt&quot;</span><span class="p">)(</span><span class="n">validate_fiware_datatype_string_protect</span><span class="p">)</span>

    <span class="n">modifiedAt</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Timestamp&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Representing a timestamp for the &quot;</span>
        <span class="s2">&quot;last modification of the property.&quot;</span><span class="p">,</span>
        <span class="n">max_length</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
        <span class="n">min_length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">field_validator</span><span class="p">(</span><span class="s2">&quot;modifiedAt&quot;</span><span class="p">)(</span><span class="n">validate_fiware_datatype_string_protect</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">data</span><span class="p">):</span>
        <span class="c1"># There is currently no validation for extra fields</span>
        <span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_validate_attributes</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span>

<div class="viewcode-block" id="ContextLDEntity.get_model_fields_set"><a class="viewcode-back" href="../../../../code/filip.models.ngsi_ld.html#filip.models.ngsi_ld.context.ContextLDEntity.get_model_fields_set">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_model_fields_set</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get all names and aliases of the model fields.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">set</span><span class="p">(</span>
            <span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">validation_alias</span> <span class="k">for</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">model_fields</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
            <span class="o">+</span> <span class="p">[</span><span class="n">field_name</span> <span class="k">for</span> <span class="n">field_name</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">model_fields</span><span class="p">]</span>
        <span class="p">)</span></div>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_validate_single_property</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span> <span class="n">attr</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">ContextProperty</span><span class="p">,</span> <span class="n">ContextRelationship</span><span class="p">,</span> <span class="n">ContextGeoProperty</span><span class="p">]:</span>
        <span class="c1"># skip validation if pre-defined model is already used</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ContextProperty</span><span class="p">,</span> <span class="n">ContextRelationship</span><span class="p">,</span> <span class="n">ContextGeoProperty</span><span class="p">]:</span>
            <span class="k">return</span> <span class="n">attr</span>
        <span class="n">property_fields</span> <span class="o">=</span> <span class="n">ContextProperty</span><span class="o">.</span><span class="n">get_model_fields_set</span><span class="p">()</span>
        <span class="n">property_fields</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="c1"># subattrs = {}</span>
        <span class="k">if</span> <span class="n">attr</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;Relationship&quot;</span><span class="p">:</span>
            <span class="n">attr_instance</span> <span class="o">=</span> <span class="n">ContextRelationship</span><span class="o">.</span><span class="n">model_validate</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">attr</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;GeoProperty&quot;</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">attr_instance</span> <span class="o">=</span> <span class="n">ContextGeoProperty</span><span class="o">.</span><span class="n">model_validate</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">elif</span> <span class="n">attr</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;Property&quot;</span> <span class="ow">or</span> <span class="n">attr</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">attr_instance</span> <span class="o">=</span> <span class="n">ContextProperty</span><span class="o">.</span><span class="n">model_validate</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Attribute </span><span class="si">{</span><span class="n">attr</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span> <span class="s2">&quot;is not a valid type&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">subkey</span><span class="p">,</span> <span class="n">subattr</span> <span class="ow">in</span> <span class="n">attr</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subattr</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="n">subkey</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">property_fields</span><span class="p">:</span>
                <span class="n">attr_instance</span><span class="o">.</span><span class="n">model_extra</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                    <span class="p">{</span><span class="n">subkey</span><span class="p">:</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_validate_single_property</span><span class="p">(</span><span class="n">attr</span><span class="o">=</span><span class="n">subattr</span><span class="p">)}</span>
                <span class="p">)</span>
        <span class="k">return</span> <span class="n">attr_instance</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_validate_attributes</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">):</span>
        <span class="n">entity_fields</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_model_fields_set</span><span class="p">()</span>
        <span class="n">entity_fields</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="c1"># Initialize the attribute dictionary</span>
        <span class="n">attrs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># Iterate through the data</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c1"># Check if the keyword is not already present in the fields</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">entity_fields</span><span class="p">:</span>
                <span class="n">attrs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_validate_single_property</span><span class="p">(</span><span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">attrs</span>

<div class="viewcode-block" id="ContextLDEntity.model_dump"><a class="viewcode-back" href="../../../../code/filip.models.ngsi_ld.html#filip.models.ngsi_ld.context.ContextLDEntity.model_dump">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">model_dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">model_dump</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">by_alias</span><span class="o">=</span><span class="n">by_alias</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

    <span class="nd">@field_validator</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_validate_id</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">id</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;urn:ngsi-ld:&quot;</span><span class="p">):</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;It is recommended that the entity id to be a URN,&quot;</span>
                <span class="s1">&#39;starting with the namespace &quot;urn:ngsi-ld:&quot;&#39;</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="nb">id</span>

<div class="viewcode-block" id="ContextLDEntity.get_properties"><a class="viewcode-back" href="../../../../code/filip.models.ngsi_ld.html#filip.models.ngsi_ld.context.ContextLDEntity.get_properties">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_properties</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">response_format</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PropertyFormat</span><span class="p">]</span> <span class="o">=</span> <span class="n">PropertyFormat</span><span class="o">.</span><span class="n">LIST</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">NamedContextProperty</span><span class="p">],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ContextProperty</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get all properties of the entity.</span>
<span class="sd">        Args:</span>
<span class="sd">            response_format:</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response_format</span> <span class="o">=</span> <span class="n">PropertyFormat</span><span class="p">(</span><span class="n">response_format</span><span class="p">)</span>
        <span class="c1"># response format dict:</span>
        <span class="k">if</span> <span class="n">response_format</span> <span class="o">==</span> <span class="n">PropertyFormat</span><span class="o">.</span><span class="n">DICT</span><span class="p">:</span>
            <span class="n">final_dict</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dump</span><span class="p">(</span><span class="n">exclude_unset</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ContextLDEntity</span><span class="o">.</span><span class="n">get_model_fields_set</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="n">DataTypeLD</span><span class="o">.</span><span class="n">RELATIONSHIP</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">DataTypeLD</span><span class="o">.</span><span class="n">GEOPROPERTY</span><span class="p">:</span>
                            <span class="n">final_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ContextGeoProperty</span><span class="p">(</span><span class="o">**</span><span class="n">value</span><span class="p">)</span>
                        <span class="k">elif</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">DataTypeLD</span><span class="o">.</span><span class="n">PROPERTY</span><span class="p">:</span>
                            <span class="n">final_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ContextProperty</span><span class="p">(</span><span class="o">**</span><span class="n">value</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>  <span class="c1"># named context property by default</span>
                            <span class="n">final_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ContextProperty</span><span class="p">(</span><span class="o">**</span><span class="n">value</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">final_dict</span>
        <span class="c1"># response format list:</span>
        <span class="n">final_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dump</span><span class="p">(</span><span class="n">exclude_unset</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ContextLDEntity</span><span class="o">.</span><span class="n">get_model_fields_set</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="n">DataTypeLD</span><span class="o">.</span><span class="n">RELATIONSHIP</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">DataTypeLD</span><span class="o">.</span><span class="n">GEOPROPERTY</span><span class="p">:</span>
                        <span class="n">final_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">NamedContextGeoProperty</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="o">**</span><span class="n">value</span><span class="p">))</span>
                    <span class="k">elif</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">DataTypeLD</span><span class="o">.</span><span class="n">PROPERTY</span><span class="p">:</span>
                        <span class="n">final_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">NamedContextProperty</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="o">**</span><span class="n">value</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>  <span class="c1"># named context property by default</span>
                        <span class="n">final_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">NamedContextProperty</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="o">**</span><span class="n">value</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">final_list</span></div>

<div class="viewcode-block" id="ContextLDEntity.delete_relationships"><a class="viewcode-back" href="../../../../code/filip.models.ngsi_ld.html#filip.models.ngsi_ld.context.ContextLDEntity.delete_relationships">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">delete_relationships</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">relationships</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Delete the given relationships from the entity</span>

<span class="sd">        Args:</span>
<span class="sd">            relationships: List of relationship names</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">all_relationships</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_relationships</span><span class="p">(</span><span class="n">response_format</span><span class="o">=</span><span class="s2">&quot;dict&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">relationship</span> <span class="ow">in</span> <span class="n">relationships</span><span class="p">:</span>
            <span class="c1"># check they are relationships</span>
            <span class="k">if</span> <span class="n">relationship</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">all_relationships</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Relationship </span><span class="si">{</span><span class="n">relationship</span><span class="si">}</span><span class="s2"> does not exist&quot;</span><span class="p">)</span>
            <span class="nb">delattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">relationship</span><span class="p">)</span></div>

<div class="viewcode-block" id="ContextLDEntity.delete_properties"><a class="viewcode-back" href="../../../../code/filip.models.ngsi_ld.html#filip.models.ngsi_ld.context.ContextLDEntity.delete_properties">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">delete_properties</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">props</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ContextProperty</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="n">NamedContextProperty</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Delete the given properties from the entity</span>

<span class="sd">        Args:</span>
<span class="sd">            props: can be given in multiple forms</span>
<span class="sd">                1) Dict: {&quot;&lt;property_name&gt;&quot;: ContextProperty, ...}</span>
<span class="sd">                2) List: [NamedContextProperty, ...]</span>
<span class="sd">                3) List: [&quot;&lt;property_name&gt;&quot;, ...]</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">props</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">props</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">NamedContextProperty</span><span class="p">):</span>
                    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">names</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">props</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>

        <span class="c1"># check there are no relationships</span>
        <span class="n">relationship_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">rel</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">rel</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_relationships</span><span class="p">()]</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">relationship_names</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> is a relationship&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
            <span class="nb">delattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="ContextLDEntity.add_geo_properties"><a class="viewcode-back" href="../../../../code/filip.models.ngsi_ld.html#filip.models.ngsi_ld.context.ContextLDEntity.add_geo_properties">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_geo_properties</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">attrs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ContextGeoProperty</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="n">NamedContextGeoProperty</span><span class="p">]]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add property to entity</span>
<span class="sd">        Args:</span>
<span class="sd">            attrs:</span>
<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attrs</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">attr</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">ContextGeoProperty</span><span class="p">(</span>
                    <span class="o">**</span><span class="n">attr</span><span class="o">.</span><span class="n">model_dump</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">},</span> <span class="n">exclude_unset</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">attrs</span>
            <span class="p">}</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">attrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">attr</span><span class="p">)</span></div>

<div class="viewcode-block" id="ContextLDEntity.add_properties"><a class="viewcode-back" href="../../../../code/filip.models.ngsi_ld.html#filip.models.ngsi_ld.context.ContextLDEntity.add_properties">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_properties</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">attrs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ContextProperty</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="n">NamedContextProperty</span><span class="p">]]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add property to entity</span>
<span class="sd">        Args:</span>
<span class="sd">            attrs:</span>
<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attrs</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">attr</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">ContextProperty</span><span class="p">(</span>
                    <span class="o">**</span><span class="n">attr</span><span class="o">.</span><span class="n">model_dump</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">},</span> <span class="n">exclude_unset</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">attrs</span>
            <span class="p">}</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">attrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">attr</span><span class="p">)</span></div>

<div class="viewcode-block" id="ContextLDEntity.add_relationships"><a class="viewcode-back" href="../../../../code/filip.models.ngsi_ld.html#filip.models.ngsi_ld.context.ContextLDEntity.add_relationships">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_relationships</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">relationships</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span>
            <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ContextRelationship</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="n">NamedContextRelationship</span><span class="p">]</span>
        <span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add relationship to entity</span>
<span class="sd">        Args:</span>
<span class="sd">            relationships:</span>
<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">relationships</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">relationships</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">attr</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">ContextRelationship</span><span class="p">(</span><span class="o">**</span><span class="n">attr</span><span class="o">.</span><span class="n">dict</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">}))</span>
                <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">relationships</span>
            <span class="p">}</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">relationships</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">attr</span><span class="p">)</span></div>

<div class="viewcode-block" id="ContextLDEntity.get_relationships"><a class="viewcode-back" href="../../../../code/filip.models.ngsi_ld.html#filip.models.ngsi_ld.context.ContextLDEntity.get_relationships">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_relationships</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">response_format</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PropertyFormat</span><span class="p">]</span> <span class="o">=</span> <span class="n">PropertyFormat</span><span class="o">.</span><span class="n">LIST</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">NamedContextRelationship</span><span class="p">],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ContextRelationship</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get all relationships of the context entity</span>

<span class="sd">        Args:</span>
<span class="sd">            response_format:</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response_format</span> <span class="o">=</span> <span class="n">PropertyFormat</span><span class="p">(</span><span class="n">response_format</span><span class="p">)</span>
        <span class="c1"># response format dict:</span>
        <span class="k">if</span> <span class="n">response_format</span> <span class="o">==</span> <span class="n">PropertyFormat</span><span class="o">.</span><span class="n">DICT</span><span class="p">:</span>
            <span class="n">final_dict</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dump</span><span class="p">(</span><span class="n">exclude_unset</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ContextLDEntity</span><span class="o">.</span><span class="n">get_model_fields_set</span><span class="p">():</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">DataTypeLD</span><span class="o">.</span><span class="n">RELATIONSHIP</span><span class="p">:</span>
                            <span class="n">final_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ContextRelationship</span><span class="p">(</span><span class="o">**</span><span class="n">value</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>  <span class="c1"># if context attribute</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                            <span class="k">pass</span>
            <span class="k">return</span> <span class="n">final_dict</span>
        <span class="c1"># response format list:</span>
        <span class="n">final_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dump</span><span class="p">(</span><span class="n">exclude_unset</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ContextLDEntity</span><span class="o">.</span><span class="n">get_model_fields_set</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">DataTypeLD</span><span class="o">.</span><span class="n">RELATIONSHIP</span><span class="p">:</span>
                    <span class="n">final_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">NamedContextRelationship</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="o">**</span><span class="n">value</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">final_list</span></div>

<div class="viewcode-block" id="ContextLDEntity.get_context"><a class="viewcode-back" href="../../../../code/filip.models.ngsi_ld.html#filip.models.ngsi_ld.context.ContextLDEntity.get_context">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_context</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            response_format:</span>

<span class="sd">        Returns: context of the entity as list</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dump</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;context&quot;</span><span class="p">})</span><span class="o">.</span><span class="n">popitem</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">context</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;No context in entity&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">context</span></div>

<div class="viewcode-block" id="ContextLDEntity.to_keyvalues"><a class="viewcode-back" href="../../../../code/filip.models.ngsi_ld.html#filip.models.ngsi_ld.context.ContextLDEntity.to_keyvalues">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_keyvalues</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ContextLDEntityKeyValues</span><span class="p">:</span>
        <span class="n">props</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_properties</span><span class="p">()</span>
        <span class="n">rels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_relationships</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]()</span>
        <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">props</span><span class="p">:</span>
            <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">prop</span><span class="o">.</span><span class="n">value</span>
        <span class="k">for</span> <span class="n">rel</span> <span class="ow">in</span> <span class="n">rels</span><span class="p">:</span>
            <span class="n">result</span><span class="p">[</span><span class="n">rel</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">rel</span><span class="o">.</span><span class="n">object</span>
        <span class="k">return</span> <span class="n">ContextLDEntityKeyValues</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="o">**</span><span class="n">result</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="ActionTypeLD"><a class="viewcode-back" href="../../../../code/filip.models.ngsi_ld.html#filip.models.ngsi_ld.context.ActionTypeLD">[docs]</a><span class="k">class</span><span class="w"> </span><span class="nc">ActionTypeLD</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Options for queries</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CREATE</span> <span class="o">=</span> <span class="s2">&quot;create&quot;</span>
    <span class="n">UPSERT</span> <span class="o">=</span> <span class="s2">&quot;upsert&quot;</span>
    <span class="n">UPDATE</span> <span class="o">=</span> <span class="s2">&quot;update&quot;</span>
    <span class="n">DELETE</span> <span class="o">=</span> <span class="s2">&quot;delete&quot;</span></div>


<div class="viewcode-block" id="UpdateLD"><a class="viewcode-back" href="../../../../code/filip.models.ngsi_ld.html#filip.models.ngsi_ld.context.UpdateLD">[docs]</a><span class="k">class</span><span class="w"> </span><span class="nc">UpdateLD</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Model for update action</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">entities</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">ContextLDEntity</span><span class="p">,</span> <span class="n">ContextLDEntityKeyValues</span><span class="p">]]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;an array of entities, each entity specified using the &quot;</span>
        <span class="s2">&quot;JSON entity representation format &quot;</span>
    <span class="p">)</span></div>


<div class="viewcode-block" id="MessageLD"><a class="viewcode-back" href="../../../../code/filip.models.ngsi_ld.html#filip.models.ngsi_ld.context.MessageLD">[docs]</a><span class="k">class</span><span class="w"> </span><span class="nc">MessageLD</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Model for a notification message, when sent to other NGSIv2-APIs</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">subscriptionId</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Id of the subscription the notification comes from&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">ContextLDEntity</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;is an array with the notification data itself which &quot;</span>
        <span class="s2">&quot;includes the entity and all concerned attributes. Each &quot;</span>
        <span class="s2">&quot;element in the array corresponds to a different entity. &quot;</span>
        <span class="s2">&quot;By default, the entities are represented in normalized &quot;</span>
        <span class="s2">&quot;mode. However, using the attrsFormat modifier, a &quot;</span>
        <span class="s2">&quot;simplified representation mode can be requested.&quot;</span>
    <span class="p">)</span></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021-2025, RWTH Aachen University, E.ON Energy Research Center, Institute for Energy Efficient Buildings and Indoor Climate.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>